<!doctype html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="icon" href="/favicon.ico">
    <title>Hexo博客搭建及个性化主题</title>
    
    <link href="https://fonts.googleapis.com/css?family=Chivo|Work+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/regular.css" integrity="sha384-ZlNfXjxAqKFWCwMwQFGhmMh3i89dWDnaFU2/VZg9CvsMGA7hXHQsPIqS+JIAmgEq" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/fontawesome.css" integrity="sha384-1rquJLNOM3ijoueaaeS5m+McXPJCGdr5HcA03/VHXxcp2kX2sUrQDmFc3jR5i/C7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/oitsi.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
    <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css">
    
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
    <body>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#nav-collapse" aria-controls="nav-collapse" aria-expanded="false" aria-label="">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse nav-content" id="nav-collapse">
            <a class="navbar-brand" href="/">
                <span class="brand-name">酒窝里</span>
            </a>
            <div class="nav-links">
                <ul id="navbar-links" class="navbar-nav active">
                    
                        <li class="nav-item">
                            <a  
                                    class="nav-link active"
                                
                                href="/./">
                                文章
                            </a>
                        </li>
                    
                        <li class="nav-item">
                            <a  
                                    class="nav-link"
                                
                                href="/archives/">
                                归档
                            </a>
                        </li>
                    
                        <li class="nav-item">
                            <a  
                                    class="nav-link"
                                
                                href="/about/">
                                关于
                            </a>
                        </li>
                    
                </ul>
            </div>
        </div>
    </nav>
</header>

        <div class="blog">
            <div class="container-fluid">
                
<div class="main-content post-content row">
    <div class="post-header">
        <h1>Hexo博客搭建及个性化主题</h1>
        <p class="meta-line">
            
                <i class="far fa-folder-open"></i>&nbsp;<a href="/archives/categories/博客/">博客</a>&nbsp;&nbsp;
            
                <i class="far fa-calendar-alt"></i>&nbsp;2016-12-26
        </p>
    </div>
    <p>如何快速地搭建起博客写作平台，记录生活中的点滴？拥抱MD，拥抱静态博客文件生成与托管方式吧！本文记录了使用Hexo引擎的博客平台的搭建过程，以及本博客使用的自定义主题开发的相关内容。</p>
<h2 id="搭建博客"><a class="markdownIt-Anchor" href="#搭建博客"></a> 搭建博客</h2>
<p><a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>作为静态博客生成的优势是简单易用，循着官网上的流程，可以快速搭建起自己的博客平台。通过编写符合markdown语法的文件，Hexo中以及社区贡献的JavaScript插件可以将它们解析成HTML静态文件提供访问。</p>
<p>使用<code>hexo init</code>之后，会将一个最基础的博客<code>hexo-starter</code>克隆到本地目录。其中的<code>package.json</code>中展示了使用的一些基本插件：</p>
<pre class="highlight"><code class="bash"><span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"hexo"</span>: <span class="hljs-string">"^3.7.0"</span>,
    <span class="hljs-string">"hexo-generator-archive"</span>: <span class="hljs-string">"^0.1.5"</span>,
    <span class="hljs-string">"hexo-generator-category"</span>: <span class="hljs-string">"^0.1.3"</span>,
    <span class="hljs-string">"hexo-generator-index"</span>: <span class="hljs-string">"^0.2.1"</span>,
    <span class="hljs-string">"hexo-generator-tag"</span>: <span class="hljs-string">"^0.2.0"</span>,	<span class="hljs-comment"># 博客内容组织相关插件</span>
    <span class="hljs-string">"hexo-renderer-ejs"</span>: <span class="hljs-string">"^0.3.1"</span>,	<span class="hljs-comment"># 解析博客主题中的ejs文件</span>
    <span class="hljs-string">"hexo-renderer-stylus"</span>: <span class="hljs-string">"^0.3.3"</span>,	<span class="hljs-comment"># 解析博客主题中的stylus语法的css文件</span>
    <span class="hljs-string">"hexo-renderer-marked"</span>: <span class="hljs-string">"^0.3.2"</span>,	<span class="hljs-comment"># markdown文件转换插件</span>
    <span class="hljs-string">"hexo-server"</span>: <span class="hljs-string">"^0.3.1"</span>		<span class="hljs-comment"># 支持本地serve博客的插件</span>
}
</code></pre>
<p><code>node_modules</code>中有这些插件的源码，如果有需要可以直接去更改源码实现功能，或者fork出来修改之后提交自己的插件。使用<code>hexo-renderer-marked</code>时会将markdown文件的数学公式中下标<code>_</code>符号错误地解析为<code>&lt;em&gt;</code>标签。在本博客使用Latex时的解决方式是，对其中的解析为<code>&lt;em&gt;</code>的正则表达式修改去除下划线。今昔不比往日，现在本博客使用<a href="https://katex.org" target="_blank" rel="noopener">KaTex</a>来解析展示页面中的数学公式，所以把<code>hexo-renderer-marked</code>更换为<code>hexo-renderer-markdown-it-plus</code>，部署及配置可以参见插件的Github<a href="https://github.com/CHENXCHEN/hexo-renderer-markdown-it-plus" target="_blank" rel="noopener">项目主页</a>。</p>
<p>在使用过程中，很容易看到Hexo的最大不足是其文档不够翔实。其它三方开发的插件一般会在自己的主页写好使用方式，但是官方提供的插件如<code>hexo-generator-*</code>则是没有单独的文档介绍，因此博客的配置也不清不楚，定制起来比较费时。两个解决方法，使用他人的成品，或者慢慢摸索对比学习。</p>
<h2 id="自定义主题-oitsi"><a class="markdownIt-Anchor" href="#自定义主题-oitsi"></a> 自定义主题 - Oitsi</h2>
<p>初衷其实很简单，还是想要让这个博客看起来简洁而又不单调。起初是找了一些现成的，很流行也还不错的主题来尝试。最开始在<a href="https://github.com/tufu9441/maupassant-hexo" target="_blank" rel="noopener">maupassant-hexo</a>的基础上做了一些修改，去掉了很多插件，也改了一些页面的布局。整体感觉还挺满意的，最重要的收获是在折腾这个主题的过程中，学习到了Hexo主题的一般构成。中间有一段时间没有什么文章产出，也对这个主题有点审美疲劳了，就体验了另一个更简单的主题<a href="https://github.com/henryhuang/hexo-theme-aloha" target="_blank" rel="noopener">Aloha</a>。总的来说，对功能上的个人需求还得自己写代码来解决。刚好最近看到了<a href="https://istio.io/blog" target="_blank" rel="noopener">Istio</a>这个布局，看起来很简单，又能够比较清晰地展示内容，于是就决定参考定制一个镜像主题。本主题的名字也取了它的一个镜像 😃</p>
<p>从零开始看官方文档，真的没什么用处，比对着一个主题的代码来看要了解地快很多。之前对maupassant有一点定制的经验，配合一些主题教程，用上基本的HTML+CSS技术，整个开发过程还算是顺利。时间最多是被耗费在使用Bootstrap进行页面布局和写CSS文件上了。整个主题的结构：</p>
<pre class="highlight"><code class="bash">.
|-- _config.yml
|-- README.md
|-- languages		<span class="hljs-comment"># 常量的中英文对照</span>
|   `-- zh-CN.yml
|-- layout
|   |-- _partial	<span class="hljs-comment"># 页面布局中通用的区域</span>
|   |-- _widget		<span class="hljs-comment"># 页面中实现特定功能的区域</span>
|   |-- archive.ejs	<span class="hljs-comment"># 归档页</span>
|   |-- index.ejs	<span class="hljs-comment"># 博客首页</span>
|   |-- layout.ejs	<span class="hljs-comment"># 所有页面的基本布局</span>
|   |-- post.ejs	<span class="hljs-comment"># 文章详情页</span>
|   `-- single.ejs	<span class="hljs-comment"># 单独页面，用于“关于”页</span>
`-- <span class="hljs-built_in">source</span>		<span class="hljs-comment"># 会被直接拷贝到生成网站根目录下</span>
    |-- avatar.jpg
    |-- css
    |-- favicon.ico
    `-- js

</code></pre>
<p>使用这个主题还有对博客以及主题的配置文件<code>_config.yml</code>有依赖。第一版主题里，还有一些侧边栏的卡片区域的定制，在逐渐完善的过程中也将这些卡片去掉了，毕竟内容才是最重要的。</p>
<h3 id="页面布局相关"><a class="markdownIt-Anchor" href="#页面布局相关"></a> 页面布局相关</h3>
<p>上一节中提到了主题中使用的把 markdown 文件转成 HTML 的插件不是用的默认插件，所以首先得将新插件的配置扔到文件中。同时，使用了<code>highlight.js</code>做代码的高亮，所以基本配置中修改<code>highlight: enable: false</code>。所有的页面都没有使用到分页功能，配置<code>per_page: 0</code>可禁用分页：</p>
<pre class="highlight"><code class="yaml"><span class="hljs-attr">per_page:</span> <span class="hljs-number">0</span>	        <span class="hljs-comment"># 首页不分页</span>
<span class="hljs-attr">category_generator:</span>
	<span class="hljs-attr">per_page:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">tag_generator:</span>
	<span class="hljs-attr">per_page:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">archive_generator:</span>	 <span class="hljs-comment"># 归档页不分页，且没有按照年份或月份进行组织</span>
	<span class="hljs-attr">per_page:</span> <span class="hljs-number">0</span>
	<span class="hljs-attr">yearly:</span> <span class="hljs-literal">false</span>
	<span class="hljs-attr">monthly:</span> <span class="hljs-literal">false</span>
</code></pre>
<h3 id="页面内容相关"><a class="markdownIt-Anchor" href="#页面内容相关"></a> 页面内容相关</h3>
<p>博客顶栏中的导航菜单涉及到页面文件的路径，如果要进一步修改需要对其中的内容进行配置：</p>
<pre class="highlight"><code class="yaml"><span class="hljs-attr">menu:</span>
	<span class="hljs-bullet">-</span> <span class="hljs-attr">page:</span> <span class="hljs-string">Blog</span>
	  <span class="hljs-attr">directory:</span> <span class="hljs-string">./</span>
	<span class="hljs-bullet">-</span> <span class="hljs-attr">page:</span> <span class="hljs-string">Archive</span>
	  <span class="hljs-attr">directory:</span> <span class="hljs-string">archives/</span>
	<span class="hljs-bullet">-</span> <span class="hljs-attr">page:</span> <span class="hljs-string">About</span>
	  <span class="hljs-attr">directory:</span> <span class="hljs-string">about/</span>
</code></pre>
<p>在<code>oitsi.js</code>文件中，使用了Google Analytics进行页面访问统计，其中包含了特有的UA。其中的JavaScript代码也可以对代码高亮的风格进行调整，如行号、缩进。</p>
<h2 id="最后"><a class="markdownIt-Anchor" href="#最后"></a> 最后</h2>
<p>文章介绍地比较简略，事实上整个过程耗费的时间长到离谱。总的来说，自己写一个主题的学习成本还挺大的，但是熟悉了套路之后实际开发起来并不需要特别耗时地写代码。重点在于，从零开始开发出自己的主题之后，有动力实现更多的功能去完善它，或者去根据需求修改它。当前主题比较严重的不足有以下几方面：</p>
<ol>
<li>响应式布局。虽然使用的是Bootstrap，但是我自己对于其支持的响应式布局掌握不够，所以还没有实现。</li>
<li>博客图片压缩。希望在上传到服务器上时，文章中使用的图片都能够被压缩之后再上传，节省空间和带宽。</li>
</ol>
<p>同时，博客的搜索、评论等功能也值得支持，后续如果补坑的话，可能会有与本文统一类别下的更多文章。在主题开发过程中，除了Istio网站的整体风格产生的主要影响之外，这个<a href="http://www.codeblocq.com/2016/03/Create-an-Hexo-Theme-Part-1-Index/" target="_blank" rel="noopener">博客系列</a>对我的帮助也很大，同时上文中提到的两个主题的代码也启发了部分设计与实现。</p>

    <div class="post-nav container-fluid row">
        <div class="nav-prev col-6">
        
        </div><div class="nav-next col-6 text-right">
        
            <a href="/2018/07/travelling-in-jeju-korea.html">毕业之旅，济州岛&nbsp;&nbsp;<i class="far fa-arrow-alt-circle-right"></i></a>
        
        </div>
    </div>
</div>

            </div>
        </div>
        <footer class="container-fluid">
    <div class="row">
        <div class="col-12 col-lg-12">
            <p class="text-center copyright">
                酒窝里
                <br>
                © 2018 Xiaoxi Wang
                <br>
                Powered by <a href="https://hexo.io" target="_blank" title="Hexo">Hexo</a>,
                Applied theme <a href="https://github.com/creekwax/hexo-theme-oitsi" target="_blank" title="Oitsi">Oitsi</a> 
            </p>
        </div>
    </div>
</footer>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script async src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script async src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script>
<script defer src="//cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js"></script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script defer src="/js/oitsi.js" type="application/javascript"></script>

    </body>
</html>
